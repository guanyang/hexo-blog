---
title: IDEA+EmmyLua Lua开发环境搭建
catalog: true
comments: true
indexing: true
header-img: ../../../../img/default.jpg
top: false
tocnum: true
date: 2021-11-12 19:44:34
subtitle: IDEA安装EmmyLua插件，方便本地调试lua脚本
tags:
- Lua
- IDEA
categories:
- 开发环境
---

### IDEA安装EmmyLua插件
- https://emmylua.github.io/installation/repo.html

### 下载MoDebug
- https://github.com/pkulchenko/MobDebug
- 从github下载MobDebug项目，把项目中的mobdebug.lua，拷贝到项目的src目录下，内核基于mobdebug.lua 

### 关键步骤（mac安装）
```bash
-- 安装lua
brew install lua

-- 安装luarocks工具
brew install luarocks

-- 安装luasocket
luarocks install luasocket

-- 安装lua-cjson（可选）
luarocks install lua-cjson 2.1.0-1

-- 安装redis-lua（可选）
luarocks install redis-lua
```

### 远程调试
- https://emmylua.github.io/run/remote.html

### 示例代码

```bash
---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by gy.
--- DateTime: 2021/10/27 20:16
---

-- 调试配置相关代码，实际使用不需要 start--
--require("mobdebug").start()

local cjson = require 'cjson'
local redis = require 'redis'
local host = "127.0.0.1"
local port = 6379
client = redis.connect(host, port)

redis.call = function(cmd, ...)
    return assert(load('return client:' .. string.lower(cmd) .. '(...)'))(...)
end
-- 调试配置相关代码，实际使用不需要 end--


local KEYS = { "test1", "test2" }
local ARGV = { "1", '{\"age\":\"23\",\"name\":\"test\"}' }

local value = redis.call("GET", "key1")
print(value)

local queueListRedisKey = KEYS[1]
print(queueListRedisKey)

local userInfoObj = cjson.decode(ARGV[2])
print(cjson.encode(userInfoObj))
```